---
import BaseHead from '../../components/BaseHead.astro';
import Analytics from '../../components/Analytics.astro';
import BlogHeader from '../../components/BlogHeader.astro';
import BlogPost from '../../layouts/BlogPost.astro';
import { parse } from 'node-html-parser';

import wordpress from '../../wordpress';

export async function getStaticPaths() {
	const {
		data: { posts },
	} = await wordpress.getPosts(100);

	return posts.map((p) => ({
		params: {
			post: String(p.ID),
		},
		props: {
			post_obj: p,
		},
	}));
}

const post = Astro.props.post_obj;
// const img = Object.values(post.attachments)[0]?.URL;
const img = post.featured_image;
const content = {
	title: parse(post.title).text,
	description: post.excerpt,
	publishDate: post.date,
	author: 'test',
	heroImage: img,
	permalink: 'test',
	alt: post.slug,
	text: post.content,
	id: post.ID,
};

// console.log(post.content)
---

<BlogPost content={content} />
